#pragma once

#include "ABI.h"

namespace rrtmgp {

void interpolation_fpga(
    const int ncol,
    const int nlay,
    const int ngas,
    const int nflav,
    const int neta,
    const int npres,
    const int ntemp,
    const int flavor[16],
    const REAL press_ref_log[59],
    const REAL temp_ref[14],
    REAL press_ref_log_delta,
    REAL temp_ref_min,
    REAL temp_ref_delta,
    REAL press_ref_trop_log,
    const REAL vmr_ref[168],
    const REAL play[60],
    const REAL tlay[60],
    const REAL col_gas[480],
    int jtemp[60],
    REAL fmajor[3840],
    REAL fminor[1920],
    REAL col_mix[960],
    BOOL tropo[60],
    int jeta[960],
    int jpress[60]);

void combine_abs_and_rayleigh_fpga(
    const int ncol,
    const int nlay,
    const int ngpt,
    const REAL* tau_local,
    const REAL* tau_rayleigh,
    REAL* tau,
    REAL* ssa,
    REAL* g);

void compute_tau_rayleigh_fpga(
    const int ncol,
    const int nlay,
    const int nbnd,
    const int ngpt,
    const int ngas,
    const int nflav,
    const int neta,
    const int npres,
    const int ntemp,
    const int gpoint_flavor[224],
    const int gpoint_bands[112],
    const int band_lims_gpt[28],
    const REAL krayl[28224],
    int idx_h2o,
    const REAL col_dry[60],
    const REAL col_gas[480],
    const REAL fminor[1920],
    const int jeta[960],
    const BOOL tropo[60],
    const int jtemp[60],
    REAL tau_rayleigh[6720]);

void compute_tau_absorption_fpga(
    const int ncol,
    const int nlay,
    const int nband,
    const int ngpt,
    const int ngas,
    const int nflav,
    const int neta,
    const int npres,
    const int ntemp,
    const int nminorlower,
    const int nminorklower,
    const int nminorupper,
    const int nminorkupper,
    const int idx_h2o,
    const int gpoint_flavor[224],
    const int band_lims_gpt[28],
    const REAL kmajor[846720],
    const REAL kminor_lower[6552],
    const REAL kminor_upper[5670],
    const int minor_limits_gpt_lower[12],
    const int minor_limits_gpt_upper[10],
    const BOOL minor_scales_with_density_lower[6],
    const BOOL minor_scales_with_density_upper[5],
    const BOOL scale_by_complement_lower[6],
    const BOOL scale_by_complement_upper[5],
    const int idx_minor_lower[6],
    const int idx_minor_upper[5],
    const int idx_minor_scaling_lower[6],
    const int idx_minor_scaling_upper[5],
    const int kminor_start_lower[6],
    const int kminor_start_upper[5],
    const BOOL tropo[60],
    const REAL col_mix[960],
    const REAL fmajor[3840],
    const REAL fminor[1920],
    const REAL play[60],
    const REAL tlay[60],
    const REAL col_gas[480],
    const int jeta[960],
    const int jtemp[60],
    const int jpress[60],
    REAL tau[6720]);

void Planck_source(
    const int ncol,
    const int nlay,
    const int nbnd,
    const int ngpt,
    const int nflav,
    const int neta,
    const int npres,
    const int ntemp,
    const int nPlanckTemp,
    const REAL* tlay,
    const REAL* tlev,
    const REAL* tsfc,
    const int sfc_lay,
    const REAL* fmajor,
    const int* jeta,
    const BOOL* tropo,
    const int* jtemp,
    const int* jpress,
    const int* gpoint_bands,
    const int* band_lims_gpt,
    const REAL* pfracin,
    const REAL temp_ref_min,
    const REAL totplnk_delta,
    const REAL* totplnk,
    const int* gpoint_flavor,
    REAL* sfc_src,
    REAL* lay_src,
    REAL* lev_src_inc,
    REAL* lev_src_dec,
    REAL* sfc_src_jac);

} // namespace rrtmgp
